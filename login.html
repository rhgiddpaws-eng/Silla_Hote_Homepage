<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Login | 신라스테이</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&family=Cormorant+Garamond:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="styles.css" />
  <script src="https://accounts.google.com/gsi/client" async defer></script>
</head>
<body>
  <div id="header-wrap"></div>
  <main class="main-content page-sub">
    <section class="sub-hero">
      <div class="sub-hero-bg" style="background-image: url('https://images.unsplash.com/photo-1566073771259-6a8506099945?w=1920')"></div>
      <h1 class="sub-hero-title">Login</h1>
    </section>
    <section class="section">
      <div class="login-wrap page-content">
        <p class="section-lead">신라스테이 멤버십으로 로그인하세요.</p>

        <!-- Google 로그인 -->
        <div class="login-google">
          <p class="login-label">Google로 로그인</p>
          <div id="googleBtn"></div>
          <p class="login-note">Google 계정으로 간편 로그인합니다. 실제 운영 시 Google Cloud Console에서 Client ID 설정이 필요합니다.</p>
        </div>

        <!-- 카카오 로그인 -->
        <div class="login-sns login-kakao">
          <p class="login-label">카카오로 로그인</p>
          <button type="button" id="kakaoLoginBtn" class="btn-sns btn-kakao" aria-label="카카오 로그인">
            <span class="btn-sns-icon kakao-icon">K</span>
            카카오 로그인
          </button>
          <p class="login-note">카카오 계정으로 로그인합니다. 실제 운영 시 카카오 개발자 콘솔에서 JavaScript 키 설정이 필요합니다.</p>
        </div>

        <!-- 네이버 로그인 -->
        <div class="login-sns login-naver">
          <p class="login-label">네이버로 로그인</p>
          <button type="button" id="naverLoginBtn" class="btn-sns btn-naver" aria-label="네이버 로그인">
            <span class="btn-sns-icon naver-icon">N</span>
            네이버 로그인
          </button>
          <p class="login-note">네이버 계정으로 로그인합니다. 실제 운영 시 네이버 개발자 센터에서 Client ID 설정이 필요합니다.</p>
        </div>

        <div class="login-divider"><span>또는</span></div>

        <!-- 이메일 로그인 (데모용, 실제 전송 없음) -->
        <form class="login-form" id="loginForm">
          <div class="form-group">
            <label for="loginEmail">이메일</label>
            <input type="email" id="loginEmail" name="email" required placeholder="example@email.com" />
          </div>
          <div class="form-group">
            <label for="loginPassword">비밀번호</label>
            <input type="password" id="loginPassword" name="password" required placeholder="비밀번호" />
          </div>
          <button type="submit" class="btn-primary btn-block">이메일로 로그인</button>
        </form>

        <p class="login-footer">
          계정이 없으신가요? <a href="register.html">회원가입</a>
        </p>
      </div>
    </section>
  </main>
  <div id="footer-wrap"></div>
  <script src="load-layout.js"></script>
  <script>
    (function () {
      // Google 로그인 콜백
      function handleCredentialResponse(response) {
        var credential = response.credential;
        if (!credential) return;
        try {
          var payload = JSON.parse(atob(credential.split('.')[1]));
          var user = {
            email: payload.email || '',
            name: payload.name || payload.email,
            picture: payload.picture || ''
          };
          sessionStorage.setItem('shillastay_user', JSON.stringify(user));
          alert('로그인 성공! ' + user.name + '님 환영합니다.');
          window.location.href = document.referrer && document.referrer.indexOf(window.location.host) !== -1 ? document.referrer : 'index.html';
        } catch (e) {
          console.error('[v0] Google login error:', e);
          alert('로그인 처리 중 오류가 발생했습니다.');
        }
      }

      // Google Identity Services 초기화 (데모용 - 실제 사용 시 Client ID 교체 필요)
      var GOOGLE_CLIENT_ID = 'YOUR_GOOGLE_CLIENT_ID.apps.googleusercontent.com';
      
      // Google SDK가 로드되면 초기화
      setTimeout(function() {
        if (window.google && window.google.accounts) {
          google.accounts.id.initialize({
            client_id: GOOGLE_CLIENT_ID,
            callback: handleCredentialResponse,
            auto_select: false
          });
          google.accounts.id.renderButton(document.getElementById('googleBtn'), {
            type: 'standard',
            theme: 'outline',
            size: 'large',
            text: 'signin_with',
            shape: 'rectangular',
            logo_alignment: 'left',
            width: 280
          });
        } else {
          // Google SDK 미로드 시 안내 메시지
          document.getElementById('googleBtn').innerHTML = '<div style="padding: 1rem; background: #f5f5f5; border-radius: 6px; text-align: center;"><p style="margin: 0 0 0.5rem; color: #666; font-size: 0.9rem;">Google 로그인은 실제 배포 시 Google Cloud Console에서 Client ID를 발급받아 설정해야 합니다.</p><a href="https://console.cloud.google.com/apis/credentials" target="_blank" rel="noopener" class="btn-primary" style="display: inline-block; margin-top: 0.5rem;">Google Cloud Console로 이동</a></div>';
        }
      }, 1000);

      // 카카오 로그인 (데모: 실제 운영 시 Kakao JavaScript SDK + REST API 키로 교체)
      document.getElementById('kakaoLoginBtn').addEventListener('click', function () {
        var user = { email: 'kakao@demo.shillastay', name: '카카오 사용자', provider: 'kakao' };
        sessionStorage.setItem('shillastay_user', JSON.stringify(user));
        alert('로그인 성공! ' + user.name + '님 환영합니다. (데모)');
        window.location.href = 'index.html';
      });

      // 네이버 로그인 (데모: 실제 운영 시 네이버 로그인 API Client ID로 교체)
      document.getElementById('naverLoginBtn').addEventListener('click', function () {
        var user = { email: 'naver@demo.shillastay', name: '네이버 사용자', provider: 'naver' };
        sessionStorage.setItem('shillastay_user', JSON.stringify(user));
        alert('로그인 성공! ' + user.name + '님 환영합니다. (데모)');
        window.location.href = 'index.html';
      });

      // 이메일 로그인 (데모: sessionStorage에 저장 후 리다이렉트)
      document.getElementById('loginForm').addEventListener('submit', function (e) {
        e.preventDefault();
        var email = document.getElementById('loginEmail').value;
        var password = document.getElementById('loginPassword').value;
        
        if (email && password) {
          var user = { email: email, name: email.split('@')[0] };
          sessionStorage.setItem('shillastay_user', JSON.stringify(user));
          alert('로그인 성공! ' + user.name + '님 환영합니다.');
          window.location.href = 'index.html';
        } else {
          alert('이메일과 비밀번호를 모두 입력해주세요.');
        }
      });
    })();
  </script>
</body>
</html>
